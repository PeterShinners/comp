; Manage a simple fake handle


!handle @mojo

!shape ~mojo-arg = {m @mojo}


!func |drop-handle ~{} = {
    ; Drop handler for all handles
    ; In a real implementation, you'd check $in to determine handle type
    $var.drop-called = #true
}


!func |drop-mojo ~mojo-arg = {
    !drop $in.m
    $var.dropped = #true
}


!func |make-mojo ~{} = {
    $var.mojo = !grab @mojo
    $var.mojo
}


!func |use-mojo ~mojo-arg = {
    ; Just return the handle  
    $in.m
}

!func |test-mojo ~any = {
    $var.m = [|make-mojo]
    $var.result1 = [{m=$var.m} |use-mojo]
}

